function x(n){var e=0,i=n.children,r=i&&i.length;if(!r)e=1;else for(;--r>=0;)e+=i[r].value;n.value=e}function N(){return this.eachAfter(x)}function I(n,e){let i=-1;for(const r of this)n.call(e,r,++i,this);return this}function T(n,e){for(var i=this,r=[i],u,o,a=-1;i=r.pop();)if(n.call(e,i,++a,this),u=i.children)for(o=u.length-1;o>=0;--o)r.push(u[o]);return this}function V(n,e){for(var i=this,r=[i],u=[],o,a,c,l=-1;i=r.pop();)if(u.push(i),o=i.children)for(a=0,c=o.length;a<c;++a)r.push(o[a]);for(;i=u.pop();)n.call(e,i,++l,this);return this}function C(n,e){let i=-1;for(const r of this)if(n.call(e,r,++i,this))return r}function L(n){return this.eachAfter(function(e){for(var i=+n(e.data)||0,r=e.children,u=r&&r.length;--u>=0;)i+=r[u].value;e.value=i})}function S(n){return this.eachBefore(function(e){e.children&&e.children.sort(n)})}function D(n){for(var e=this,i=O(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var u=r.length;n!==i;)r.splice(u,0,n),n=n.parent;return r}function O(n,e){if(n===e)return n;var i=n.ancestors(),r=e.ancestors(),u=null;for(n=i.pop(),e=r.pop();n===e;)u=n,n=i.pop(),e=r.pop();return u}function b(){for(var n=this,e=[n];n=n.parent;)e.push(n);return e}function j(){return Array.from(this)}function z(){var n=[];return this.eachBefore(function(e){e.children||n.push(e)}),n}function E(){var n=this,e=[];return n.each(function(i){i!==n&&e.push({source:i.parent,target:i})}),e}function*H(){var n=this,e,i=[n],r,u,o;do for(e=i.reverse(),i=[];n=e.pop();)if(yield n,r=n.children)for(u=0,o=r.length;u<o;++u)i.push(r[u]);while(i.length)}function q(n,e){n instanceof Map?(n=[void 0,n],e===void 0&&(e=G)):e===void 0&&(e=F);for(var i=new A(n),r,u=[i],o,a,c,l;r=u.pop();)if((a=e(r.data))&&(l=(a=Array.from(a)).length))for(r.children=a,c=l-1;c>=0;--c)u.push(o=a[c]=new A(a[c])),o.parent=r,o.depth=r.depth+1;return i.eachBefore(K)}function Z(){return q(this).eachBefore(J)}function F(n){return n.children}function G(n){return Array.isArray(n)?n[1]:null}function J(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function K(n){var e=0;do n.height=e;while((n=n.parent)&&n.height<++e)}function A(n){this.data=n,this.depth=this.height=0,this.parent=null}A.prototype=q.prototype={constructor:A,count:N,each:I,eachAfter:V,eachBefore:T,find:C,sum:L,sort:S,path:D,ancestors:b,descendants:j,leaves:z,links:E,copy:Z,[Symbol.iterator]:H};function P(n){if(typeof n!="function")throw new Error;return n}function _(){return 0}function B(n){return function(){return n}}function Q(n){n.x0=Math.round(n.x0),n.y0=Math.round(n.y0),n.x1=Math.round(n.x1),n.y1=Math.round(n.y1)}function U(n,e,i,r,u){for(var o=n.children,a,c=-1,l=o.length,v=n.value&&(r-e)/n.value;++c<l;)a=o[c],a.y0=i,a.y1=u,a.x0=e,a.x1=e+=a.value*v}function W(n,e,i,r,u){for(var o=n.children,a,c=-1,l=o.length,v=n.value&&(u-i)/n.value;++c<l;)a=o[c],a.x0=e,a.x1=r,a.y0=i,a.y1=i+=a.value*v}var X=(1+Math.sqrt(5))/2;function Y(n,e,i,r,u,o){for(var a=[],c=e.children,l,v,h=0,m=0,t=c.length,d,p,s=e.value,f,g,w,M,k,R,y;h<t;){d=u-i,p=o-r;do f=c[m++].value;while(!f&&m<t);for(g=w=f,R=Math.max(p/d,d/p)/(s*n),y=f*f*R,k=Math.max(w/y,y/g);m<t;++m){if(f+=v=c[m].value,v<g&&(g=v),v>w&&(w=v),y=f*f*R,M=Math.max(w/y,y/g),M>k){f-=v;break}k=M}a.push(l={value:f,dice:d<p,children:c.slice(h,m)}),l.dice?U(l,i,r,u,s?r+=p*f/s:o):W(l,i,r,s?i+=d*f/s:u,o),s-=f,h=m}return a}const $=(function n(e){function i(r,u,o,a,c){Y(e,r,u,o,a,c)}return i.ratio=function(r){return n((r=+r)>1?r:1)},i})(X);function nn(){var n=$,e=!1,i=1,r=1,u=[0],o=_,a=_,c=_,l=_,v=_;function h(t){return t.x0=t.y0=0,t.x1=i,t.y1=r,t.eachBefore(m),u=[0],e&&t.eachBefore(Q),t}function m(t){var d=u[t.depth],p=t.x0+d,s=t.y0+d,f=t.x1-d,g=t.y1-d;f<p&&(p=f=(p+f)/2),g<s&&(s=g=(s+g)/2),t.x0=p,t.y0=s,t.x1=f,t.y1=g,t.children&&(d=u[t.depth+1]=o(t)/2,p+=v(t)-d,s+=a(t)-d,f-=c(t)-d,g-=l(t)-d,f<p&&(p=f=(p+f)/2),g<s&&(s=g=(s+g)/2),n(t,p,s,f,g))}return h.round=function(t){return arguments.length?(e=!!t,h):e},h.size=function(t){return arguments.length?(i=+t[0],r=+t[1],h):[i,r]},h.tile=function(t){return arguments.length?(n=P(t),h):n},h.padding=function(t){return arguments.length?h.paddingInner(t).paddingOuter(t):h.paddingInner()},h.paddingInner=function(t){return arguments.length?(o=typeof t=="function"?t:B(+t),h):o},h.paddingOuter=function(t){return arguments.length?h.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):h.paddingTop()},h.paddingTop=function(t){return arguments.length?(a=typeof t=="function"?t:B(+t),h):a},h.paddingRight=function(t){return arguments.length?(c=typeof t=="function"?t:B(+t),h):c},h.paddingBottom=function(t){return arguments.length?(l=typeof t=="function"?t:B(+t),h):l},h.paddingLeft=function(t){return arguments.length?(v=typeof t=="function"?t:B(+t),h):v},h}export{q as h,nn as t};
