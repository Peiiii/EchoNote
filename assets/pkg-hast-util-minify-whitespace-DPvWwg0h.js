import{c as g}from"./pkg-unist-util-is-BPZGFiMU.js";import{i as s}from"./pkg-hast-util-is-element-Bzxglnm2.js";import{e as b}from"./pkg-hast-util-embedded-CWukGJwN.js";import{w}from"./pkg-hast-util-whitespace-D4Wp6AEg.js";const y=["address","article","aside","blockquote","body","br","caption","center","col","colgroup","dd","dialog","dir","div","dl","dt","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","legend","li","li","listing","main","menu","nav","ol","optgroup","option","p","plaintext","pre","section","summary","table","tbody","td","td","tfoot","th","th","thead","tr","ul","wbr","xmp"],d=["button","input","select","textarea"],v=["area","base","basefont","dialog","datalist","head","link","meta","noembed","noframes","param","rp","script","source","style","template","track","title"],x={},c=g(["comment","doctype"]);function j(e,t){f(e,{collapse:$((t||x).newlines?W:B),whitespace:"normal"})}function f(e,t){if("children"in e){const r={...t};return(e.type==="root"||h(e))&&(r.before=!0,r.after=!0),r.whitespace=q(e,t),A(e,r)}if(e.type==="text"){if(t.whitespace==="normal")return k(e,t);t.whitespace==="nowrap"&&(e.value=t.collapse(e.value))}return{ignore:c(e),stripAtStart:!1,remove:!1}}function k(e,t){const r=t.collapse(e.value),n={ignore:!1,stripAtStart:!1,remove:!1};let i=0,a=r.length;return t.before&&p(r.charAt(0))&&i++,i!==a&&p(r.charAt(a-1))&&(t.after?a--:n.stripAtStart=!0),i===a?n.remove=!0:e.value=r.slice(i,a),n}function A(e,t){let r=t.before;const n=t.after,i=e.children;let a=i.length,l=-1;for(;++l<a;){const o=f(i[l],{...t,after:u(i,l,n),before:r});o.remove?(i.splice(l,1),l--,a--):o.ignore||(r=o.stripAtStart),m(i[l])&&(r=!1)}return{ignore:!1,stripAtStart:!!(r||n),remove:!1}}function u(e,t,r){for(;++t<e.length;){const n=e[t];let i=S(n);if(i===void 0&&"children"in n&&!N(n)&&(i=u(n.children,-1)),typeof i=="boolean")return i}return r}function S(e){if(e.type==="element"){if(m(e))return!1;if(h(e))return!0}else if(e.type==="text"){if(!w(e))return!1}else if(!c(e))return!1}function m(e){return b(e)||s(e,d)}function h(e){return s(e,y)}function N(e){return!!(e.type==="element"&&e.properties.hidden)||c(e)||s(e,v)}function p(e){return e===" "||e===`
`}function W(e){const t=/\r?\n|\r/.exec(e);return t?t[0]:" "}function B(){return" "}function $(e){return t;function t(r){return String(r).replace(/[\t\n\v\f\r ]+/g,e)}}function q(e,t){if("tagName"in e&&e.properties)switch(e.tagName){case"listing":case"plaintext":case"script":case"style":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return e.properties.wrap?"pre-wrap":"pre";case"td":case"th":return e.properties.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap"}return t.whitespace}export{j as m};
