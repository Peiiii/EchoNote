import{f as le,c as mt,N as tt,T as de,E as ue,a as fe,S as F,b as $,P as I,d as D,k as pe,D as me,R as he,e as Bt,F as O,g as ge,h as ct,l as ve,i as be,j as ye,m as ke,n as we,o as Me,p as xe,q as Se,r as Ot,s as Ee,t as Te,u as Ae,v as Ce,w as $e,x as Pe,A as Ie,y as Ne,z as Re,B as Be,C as Oe,G as je,H as Tt,I as _e,J as Z,K as De,L as ze,M as Fe,O as Le,Q as Ve}from"./editor-CPE0OFX2.js";var He=Object.defineProperty,ht=(t,e)=>{for(var n in e)He(t,n,{get:e[n],enumerable:!0})};function et(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,o=n.storedMarks,n}}}var nt=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:s}=n,o=this.buildProps(s);return Object.fromEntries(Object.entries(t).map(([i,a])=>[i,(...l)=>{const u=a(...l)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),u}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:o}=r,i=[],a=!!t,c=t||s.tr,l=()=>(!a&&e&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),i.every(d=>d===!0)),u={...Object.fromEntries(Object.entries(n).map(([d,f])=>[d,(...m)=>{const h=this.buildProps(c,e),g=f(...m)(h);return i.push(g),u}])),run:l};return u}createCan(t){const{rawCommands:e,state:n}=this,r=!1,s=t||n.tr,o=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(e).map(([a,c])=>[a,(...l)=>c(...l)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:o}=r,i={tr:t,editor:r,view:o,state:et({state:s,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([a,c])=>[a,(...l)=>c(...l)(i)]))}};return i}},jt={};ht(jt,{blur:()=>We,clearContent:()=>qe,clearNodes:()=>Ue,command:()=>Ke,createParagraphNear:()=>Je,cut:()=>Qe,deleteCurrentNode:()=>Ze,deleteNode:()=>Ge,deleteRange:()=>Xe,deleteSelection:()=>Ye,enter:()=>tn,exitCode:()=>en,extendMarkRange:()=>nn,first:()=>rn,focus:()=>on,forEach:()=>an,insertContent:()=>cn,insertContentAt:()=>un,joinBackward:()=>mn,joinDown:()=>pn,joinForward:()=>hn,joinItemBackward:()=>gn,joinItemForward:()=>vn,joinTextblockBackward:()=>bn,joinTextblockForward:()=>yn,joinUp:()=>fn,keyboardShortcut:()=>wn,lift:()=>Mn,liftEmptyBlock:()=>xn,liftListItem:()=>Sn,newlineInCode:()=>En,resetAttributes:()=>Tn,scrollIntoView:()=>An,selectAll:()=>Cn,selectNodeBackward:()=>$n,selectNodeForward:()=>Pn,selectParentNode:()=>In,selectTextblockEnd:()=>Nn,selectTextblockStart:()=>Rn,setContent:()=>Bn,setMark:()=>Xn,setMeta:()=>Yn,setNode:()=>tr,setNodeSelection:()=>er,setTextSelection:()=>nr,sinkListItem:()=>rr,splitBlock:()=>sr,splitListItem:()=>or,toggleList:()=>ir,toggleMark:()=>ar,toggleNode:()=>cr,toggleWrap:()=>lr,undoInputRule:()=>dr,unsetAllMarks:()=>ur,unsetMark:()=>fr,updateAttributes:()=>pr,wrapIn:()=>mr,wrapInList:()=>hr});var We=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window?.getSelection())==null||n.removeAllRanges())}),!0),qe=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),Ue=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:o,$to:i})=>{t.doc.nodesBetween(o.pos,i.pos,(a,c)=>{if(a.type.isText)return;const{doc:l,mapping:u}=e,d=l.resolve(u.map(c)),f=l.resolve(u.map(c+a.nodeSize)),p=d.blockRange(f);if(!p)return;const m=ve(p);if(a.type.isTextblock){const{defaultType:h}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(p.start,h)}(m||m===0)&&e.lift(p,m)})}),!0},Ke=t=>e=>t(e),Je=()=>({state:t,dispatch:e})=>be(t,e),Qe=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,o=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const i=r.mapping.map(e);return r.insert(i,o.content),r.setSelection(new $(r.doc.resolve(Math.max(i-1,0)))),!0},Ze=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===r.type){if(e){const a=s.before(o),c=s.after(o);t.delete(a,c).scrollIntoView()}return!0}return!1};function T(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var Ge=t=>({tr:e,state:n,dispatch:r})=>{const s=T(t,n.schema),o=e.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===s){if(r){const c=o.before(i),l=o.after(i);e.delete(c,l).scrollIntoView()}return!0}return!1},Xe=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},Ye=()=>({state:t,dispatch:e})=>ye(t,e),tn=()=>({commands:t})=>t.keyboardShortcut("Enter"),en=()=>({state:t,dispatch:e})=>ke(t,e);function gt(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function X(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:gt(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function _t(t,e,n={}){return t.find(r=>r.type===e&&X(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function At(t,e,n={}){return!!_t(t,e,n)}function vt(t,e,n){var r;if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if((!s.node||!s.node.marks.some(u=>u.type===e))&&(s=t.parent.childBefore(t.parentOffset)),!s.node||!s.node.marks.some(u=>u.type===e)||(n=n||((r=s.node.marks[0])==null?void 0:r.attrs),!_t([...s.node.marks],e,n)))return;let i=s.index,a=t.start()+s.offset,c=i+1,l=a+s.node.nodeSize;for(;i>0&&At([...t.parent.child(i-1).marks],e,n);)i-=1,a-=t.parent.child(i).nodeSize;for(;c<t.parent.childCount&&At([...t.parent.child(c).marks],e,n);)l+=t.parent.child(c).nodeSize,c+=1;return{from:a,to:l}}function N(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var nn=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const o=N(t,r.schema),{doc:i,selection:a}=n,{$from:c,from:l,to:u}=a;if(s){const d=vt(c,o,e);if(d&&d.from<=l&&d.to>=u){const f=$.create(i,d.from,d.to);n.setSelection(f)}}return!0},rn=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function Dt(t){return t instanceof $}function _(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function zt(t,e=null){if(!e)return null;const n=F.atStart(t),r=F.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,o=r.to;return e==="all"?$.create(t,_(0,s,o),_(t.content.size,s,o)):$.create(t,_(e,s,o),_(e,s,o))}function sn(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function bt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var on=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:o})=>{e={scrollIntoView:!0,...e};const i=()=>{(bt()||sn())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!Dt(n.state.selection))return i(),!0;const a=zt(s.doc,t)||n.state.selection,c=n.state.selection.eq(a);return o&&(c||s.setSelection(a),c&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},an=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),cn=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),Ft=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&Ft(r)}return t};function U(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return Ft(n)}function L(t,e,n){if(t instanceof ge||t instanceof O)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,s=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return O.fromArray(t.map(a=>e.nodeFromJSON(a)));const i=e.nodeFromJSON(t);return n.errorOnInvalidContent&&i.check(),i}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),L("",e,n)}if(s){if(n.errorOnInvalidContent){let i=!1,a="";const c=new Bt({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:l=>(i=!0,a=typeof l=="string"?l:l.outerHTML,null)}]}})});if(n.slice?ct.fromSchema(c).parseSlice(U(t),n.parseOptions):ct.fromSchema(c).parse(U(t),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=ct.fromSchema(e);return n.slice?o.parseSlice(U(t),n.parseOptions).content:o.parse(U(t),n.parseOptions)}return L("",e,n)}function ln(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof Le||s instanceof Ve))return;const o=t.mapping.maps[r];let i=0;o.forEach((a,c,l,u)=>{i===0&&(i=u)}),t.setSelection(F.near(t.doc.resolve(i),n))}var dn=t=>!("type"in t),un=(t,e,n)=>({tr:r,dispatch:s,editor:o})=>{var i;if(s){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;const c=g=>{o.emit("contentError",{editor:o,error:g,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},l={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{L(e,o.schema,{parseOptions:l,errorOnInvalidContent:!0})}catch(g){c(g)}try{a=L(e,o.schema,{parseOptions:l,errorOnInvalidContent:(i=n.errorOnInvalidContent)!=null?i:o.options.enableContentCheck})}catch(g){return c(g),!1}let{from:u,to:d}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},f=!0,p=!0;if((dn(a)?a:[a]).forEach(g=>{g.check(),f=f?g.isText&&g.marks.length===0:!1,p=p?g.isBlock:!1}),u===d&&p){const{parent:g}=r.doc.resolve(u);g.isTextblock&&!g.type.spec.code&&!g.childCount&&(u-=1,d+=1)}let h;if(f){if(Array.isArray(e))h=e.map(g=>g.text||"").join("");else if(e instanceof O){let g="";e.forEach(v=>{v.text&&(g+=v.text)}),h=g}else typeof e=="object"&&e&&e.text?h=e.text:h=e;r.insertText(h,u,d)}else{h=a;const g=r.doc.resolve(u),v=g.node(),y=g.parentOffset===0,w=v.isText||v.isTextblock,M=v.content.size>0;y&&w&&M&&(u=Math.max(0,u-1)),r.replaceWith(u,d,h)}n.updateSelection&&ln(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:h}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:h})}return!0},fn=()=>({state:t,dispatch:e})=>we(t,e),pn=()=>({state:t,dispatch:e})=>Me(t,e),mn=()=>({state:t,dispatch:e})=>xe(t,e),hn=()=>({state:t,dispatch:e})=>Se(t,e),gn=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Ot(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},vn=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Ot(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},bn=()=>({state:t,dispatch:e})=>Ee(t,e),yn=()=>({state:t,dispatch:e})=>Te(t,e);function Lt(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function kn(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,o,i;for(let a=0;a<e.length-1;a+=1){const c=e[a];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))bt()||Lt()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}var wn=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const o=kn(t).split(/-(?!$)/),i=o.find(l=>!["Alt","Ctrl","Meta","Shift"].includes(l)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),c=e.captureTransaction(()=>{n.someProp("handleKeyDown",l=>l(n,a))});return c?.steps.forEach(l=>{const u=l.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function V(t,e,n={}){const{from:r,to:s,empty:o}=t.selection,i=e?T(e,t.schema):null,a=[];t.doc.nodesBetween(r,s,(d,f)=>{if(d.isText)return;const p=Math.max(r,f),m=Math.min(s,f+d.nodeSize);a.push({node:d,from:p,to:m})});const c=s-r,l=a.filter(d=>i?i.name===d.node.type.name:!0).filter(d=>X(d.node.attrs,n,{strict:!1}));return o?!!l.length:l.reduce((d,f)=>d+f.to-f.from,0)>=c}var Mn=(t,e={})=>({state:n,dispatch:r})=>{const s=T(t,n.schema);return V(n,s,e)?Ae(n,r):!1},xn=()=>({state:t,dispatch:e})=>Ce(t,e),Sn=t=>({state:e,dispatch:n})=>{const r=T(t,e.schema);return $e(r)(e,n)},En=()=>({state:t,dispatch:e})=>Pe(t,e);function rt(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Ct(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}var Tn=(t,e)=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=rt(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=T(t,r.schema)),a==="mark"&&(i=N(t,r.schema)),s&&n.selection.ranges.forEach(c=>{r.doc.nodesBetween(c.$from.pos,c.$to.pos,(l,u)=>{o&&o===l.type&&n.setNodeMarkup(u,void 0,Ct(l.attrs,e)),i&&l.marks.length&&l.marks.forEach(d=>{i===d.type&&n.addMark(u,u+l.nodeSize,i.create(Ct(d.attrs,e)))})})}),!0):!1},An=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),Cn=()=>({tr:t,dispatch:e})=>{if(e){const n=new Ie(t.doc);t.setSelection(n)}return!0},$n=()=>({state:t,dispatch:e})=>Ne(t,e),Pn=()=>({state:t,dispatch:e})=>Re(t,e),In=()=>({state:t,dispatch:e})=>Be(t,e),Nn=()=>({state:t,dispatch:e})=>Oe(t,e),Rn=()=>({state:t,dispatch:e})=>je(t,e);function ft(t,e,n={},r={}){return L(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var Bn=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:s,tr:o,dispatch:i,commands:a})=>{const{doc:c}=o;if(r.preserveWhitespace!=="full"){const l=ft(t,s.schema,r,{errorOnInvalidContent:e??s.options.enableContentCheck});return i&&o.replaceWith(0,c.content.size,l).setMeta("preventUpdate",!n),!0}return i&&o.setMeta("preventUpdate",!n),a.insertContentAt({from:0,to:c.content.size},t,{parseOptions:r,errorOnInvalidContent:e??s.options.enableContentCheck})};function Vt(t,e){const n=N(e,t.schema),{from:r,to:s,empty:o}=t.selection,i=[];o?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,c=>{i.push(...c.marks)});const a=i.find(c=>c.type.name===n.name);return a?{...a.attrs}:{}}function On(t,e){const n=new de(t);return e.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function jn(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Lr(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(s,o)=>{n(s)&&r.push({node:s,pos:o})}),r}function _n(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function st(t){return e=>_n(e.$from,t)}function b(t,e,n){return t.config[e]===void 0&&t.parent?b(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?b(t.parent,e,n):null}):t.config[e]}function yt(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=b(e,"addExtensions",n);return r?[e,...yt(r())]:e}).flat(10)}function kt(t,e){const n=me.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function Ht(t){return typeof t=="function"}function x(t,e=void 0,...n){return Ht(t)?e?t.bind(e)(...n):t(...n):t}function Dn(t={}){return Object.keys(t).length===0&&t.constructor===Object}function H(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function Wt(t){const e=[],{nodeExtensions:n,markExtensions:r}=H(t),s=[...n,...r],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage,extensions:s},c=b(i,"addGlobalAttributes",a);if(!c)return;c().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([f,p])=>{e.push({type:d,name:f,attribute:{...o,...p}})})})})}),s.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},c=b(i,"addAttributes",a);if(!c)return;const l=c();Object.entries(l).forEach(([u,d])=>{const f={...o,...d};typeof f?.default=="function"&&(f.default=f.default()),f?.isRequired&&f?.default===void 0&&delete f.default,e.push({type:i.name,name:u,attribute:f})})}),e}function zn(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,o])=>{if(!r[s]){r[s]=o;return}if(s==="class"){const a=o?String(o).split(" "):[],c=r[s]?r[s].split(" "):[],l=a.filter(u=>!c.includes(u));r[s]=[...c,...l].join(" ")}else if(s==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],c=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],l=new Map;c.forEach(u=>{const[d,f]=u.split(":").map(p=>p.trim());l.set(d,f)}),a.forEach(u=>{const[d,f]=u.split(":").map(p=>p.trim());l.set(d,f)}),r[s]=Array.from(l.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[s]=o}),r},{})}function Y(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>zn(n,r),{})}function Fn(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function $t(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((o,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(n):Fn(n.getAttribute(i.name));return a==null?o:{...o,[i.name]:a}},{});return{...r,...s}}}}function Pt(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&Dn(n)?!1:n!=null))}function Ln(t,e){var n;const r=Wt(t),{nodeExtensions:s,markExtensions:o}=H(t),i=(n=s.find(l=>b(l,"topNode")))==null?void 0:n.name,a=Object.fromEntries(s.map(l=>{const u=r.filter(v=>v.type===l.name),d={name:l.name,options:l.options,storage:l.storage,editor:e},f=t.reduce((v,y)=>{const w=b(y,"extendNodeSchema",d);return{...v,...w?w(l):{}}},{}),p=Pt({...f,content:x(b(l,"content",d)),marks:x(b(l,"marks",d)),group:x(b(l,"group",d)),inline:x(b(l,"inline",d)),atom:x(b(l,"atom",d)),selectable:x(b(l,"selectable",d)),draggable:x(b(l,"draggable",d)),code:x(b(l,"code",d)),whitespace:x(b(l,"whitespace",d)),linebreakReplacement:x(b(l,"linebreakReplacement",d)),defining:x(b(l,"defining",d)),isolating:x(b(l,"isolating",d)),attrs:Object.fromEntries(u.map(v=>{var y,w;return[v.name,{default:(y=v?.attribute)==null?void 0:y.default,validate:(w=v?.attribute)==null?void 0:w.validate}]}))}),m=x(b(l,"parseHTML",d));m&&(p.parseDOM=m.map(v=>$t(v,u)));const h=b(l,"renderHTML",d);h&&(p.toDOM=v=>h({node:v,HTMLAttributes:Y(v,u)}));const g=b(l,"renderText",d);return g&&(p.toText=g),[l.name,p]})),c=Object.fromEntries(o.map(l=>{const u=r.filter(g=>g.type===l.name),d={name:l.name,options:l.options,storage:l.storage,editor:e},f=t.reduce((g,v)=>{const y=b(v,"extendMarkSchema",d);return{...g,...y?y(l):{}}},{}),p=Pt({...f,inclusive:x(b(l,"inclusive",d)),excludes:x(b(l,"excludes",d)),group:x(b(l,"group",d)),spanning:x(b(l,"spanning",d)),code:x(b(l,"code",d)),attrs:Object.fromEntries(u.map(g=>{var v,y;return[g.name,{default:(v=g?.attribute)==null?void 0:v.default,validate:(y=g?.attribute)==null?void 0:y.validate}]}))}),m=x(b(l,"parseHTML",d));m&&(p.parseDOM=m.map(g=>$t(g,u)));const h=b(l,"renderHTML",d);return h&&(p.toDOM=g=>h({mark:g,HTMLAttributes:Y(g,u)})),[l.name,p]}));return new Bt({topNode:i,nodes:a,marks:c})}function Vn(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function wt(t){return t.sort((n,r)=>{const s=b(n,"priority")||100,o=b(r,"priority")||100;return s>o?-1:s<o?1:0})}function qt(t){const e=wt(yt(t)),n=Vn(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function Ut(t,e,n){const{from:r,to:s}=e,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let a="";return t.nodesBetween(r,s,(c,l,u,d)=>{var f;c.isBlock&&l>r&&(a+=o);const p=i?.[c.type.name];if(p)return u&&(a+=p({node:c,pos:l,parent:u,index:d,range:e})),!1;c.isText&&(a+=(f=c?.text)==null?void 0:f.slice(Math.max(r,l)-l,s-l))}),a}function Hn(t,e){const n={from:0,to:t.content.size};return Ut(t,n,e)}function Kt(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function Wn(t,e){const n=T(e,t.schema),{from:r,to:s}=t.selection,o=[];t.doc.nodesBetween(r,s,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===n.name);return i?{...i.attrs}:{}}function qn(t,e){const n=rt(typeof e=="string"?e:e.name,t.schema);return n==="node"?Wn(t,e):n==="mark"?Vt(t,e):{}}function Un(t,e=JSON.stringify){const n={};return t.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function Kn(t){const e=Un(t);return e.length===1?e:e.filter((n,r)=>!e.filter((o,i)=>i!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function Jn(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((s,o)=>{const i=[];if(s.ranges.length)s.forEach((a,c)=>{i.push({from:a,to:c})});else{const{from:a,to:c}=n[o];if(a===void 0||c===void 0)return;i.push({from:a,to:c})}i.forEach(({from:a,to:c})=>{const l=e.slice(o).map(a,-1),u=e.slice(o).map(c),d=e.invert().map(l,-1),f=e.invert().map(u);r.push({oldRange:{from:d,to:f},newRange:{from:l,to:u}})})}),Kn(r)}function Jt(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const o=n.resolve(t),i=vt(o,s.type);i&&r.push({mark:s,...i})}):n.nodesBetween(t,e,(s,o)=>{!s||s?.nodeSize===void 0||r.push(...s.marks.map(i=>({from:o,to:o+s.nodeSize,mark:i})))}),r}var Vr=(t,e,n,r=20)=>{const s=t.doc.resolve(n);let o=r,i=null;for(;o>0&&i===null;){const a=s.node(o);a?.type.name===e?i=a:o-=1}return[i,o]};function lt(t,e){return e.nodes[t]||e.marks[t]||null}function G(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(o=>o.type===e&&o.name===r);return s?s.attribute.keepOnSplit:!1}))}var Qn=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,o,i,a)=>{var c,l;const u=((l=(c=s.type.spec).toText)==null?void 0:l.call(c,{node:s,pos:o,parent:i,index:a}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-o))}),n};function pt(t,e,n={}){const{empty:r,ranges:s}=t.selection,o=e?N(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>X(d.attrs,n,{strict:!1}));let i=0;const a=[];if(s.forEach(({$from:d,$to:f})=>{const p=d.pos,m=f.pos;t.doc.nodesBetween(p,m,(h,g)=>{if(!h.isText&&!h.marks.length)return;const v=Math.max(p,g),y=Math.min(m,g+h.nodeSize),w=y-v;i+=w,a.push(...h.marks.map(M=>({mark:M,from:v,to:y})))})}),i===0)return!1;const c=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>X(d.mark.attrs,n,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),l=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,f)=>d+f.to-f.from,0);return(c>0?c+l:c)>=i}function Zn(t,e,n={}){if(!e)return V(t,null,n)||pt(t,null,n);const r=rt(e,t.schema);return r==="node"?V(t,e,n):r==="mark"?pt(t,e,n):!1}var Hr=(t,e)=>{const{$from:n,$to:r,$anchor:s}=t.selection;if(e){const o=st(a=>a.type.name===e)(t.selection);if(!o)return!1;const i=t.doc.resolve(o.pos+1);return s.pos+1===i.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},Wr=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function It(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function Nt(t,e){const{nodeExtensions:n}=H(e),r=n.find(i=>i.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},o=x(b(r,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function Mt(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let s=!0;return t.content.forEach(o=>{s!==!1&&(Mt(o,{ignoreWhitespace:n,checkChildren:e})||(s=!1))}),s}return!1}function qr(t){return t instanceof tt}function Gn(t,e,n){var r;const{selection:s}=e;let o=null;if(Dt(s)&&(o=s.$cursor),o){const a=(r=t.storedMarks)!=null?r:o.marks();return o.parent.type.allowsMarkType(n)&&(!!n.isInSet(a)||!a.some(l=>l.type.excludes(n)))}const{ranges:i}=s;return i.some(({$from:a,$to:c})=>{let l=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,c.pos,(u,d,f)=>{if(l)return!1;if(u.isInline){const p=!f||f.type.allowsMarkType(n),m=!!n.isInSet(u.marks)||!u.marks.some(h=>h.type.excludes(n));l=p&&m}return!l}),l})}var Xn=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:o}=n,{empty:i,ranges:a}=o,c=N(t,r.schema);if(s)if(i){const l=Vt(r,c);n.addStoredMark(c.create({...l,...e}))}else a.forEach(l=>{const u=l.$from.pos,d=l.$to.pos;r.doc.nodesBetween(u,d,(f,p)=>{const m=Math.max(p,u),h=Math.min(p+f.nodeSize,d);f.marks.find(v=>v.type===c)?f.marks.forEach(v=>{c===v.type&&n.addMark(m,h,c.create({...v.attrs,...e}))}):n.addMark(m,h,c.create(e))})});return Gn(r,n,c)},Yn=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),tr=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const o=T(t,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),o.isTextblock?s().command(({commands:a})=>Tt(o,{...i,...e})(n)?!0:a.clearNodes()).command(({state:a})=>Tt(o,{...i,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},er=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=_(t,0,r.content.size),o=tt.create(r,s);e.setSelection(o)}return!0},nr=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:o}=typeof t=="number"?{from:t,to:t}:t,i=$.atStart(r).from,a=$.atEnd(r).to,c=_(s,i,a),l=_(o,i,a),u=$.create(r,c,l);e.setSelection(u)}return!0},rr=t=>({state:e,dispatch:n})=>{const r=T(t,e.schema);return _e(r)(e,n)};function Rt(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e?.includes(s.type.name));t.tr.ensureMarks(r)}}var sr=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:o,doc:i}=e,{$from:a,$to:c}=o,l=s.extensionManager.attributes,u=G(l,a.node().type.name,a.node().attrs);if(o instanceof tt&&o.node.isBlock)return!a.parentOffset||!Z(i,a.pos)?!1:(r&&(t&&Rt(n,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=c.parentOffset===c.parent.content.size,f=a.depth===0?void 0:jn(a.node(-1).contentMatchAt(a.indexAfter(-1)));let p=d&&f?[{type:f,attrs:u}]:void 0,m=Z(e.doc,e.mapping.map(a.pos),1,p);if(!p&&!m&&Z(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(m=!0,p=f?[{type:f,attrs:u}]:void 0),r){if(m&&(o instanceof $&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,p),f&&!d&&!a.parentOffset&&a.parent.type!==f)){const h=e.mapping.map(a.before()),g=e.doc.resolve(h);a.node(-1).canReplaceWith(g.index(),g.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}t&&Rt(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return m},or=(t,e={})=>({tr:n,state:r,dispatch:s,editor:o})=>{var i;const a=T(t,r.schema),{$from:c,$to:l}=r.selection,u=r.selection.node;if(u&&u.isBlock||c.depth<2||!c.sameParent(l))return!1;const d=c.node(-1);if(d.type!==a)return!1;const f=o.extensionManager.attributes;if(c.parent.content.size===0&&c.node(-1).childCount===c.indexAfter(-1)){if(c.depth===2||c.node(-3).type!==a||c.index(-2)!==c.node(-2).childCount-1)return!1;if(s){let v=O.empty;const y=c.index(-1)?1:c.index(-2)?2:3;for(let A=c.depth-y;A>=c.depth-3;A-=1)v=O.from(c.node(A).copy(v));const w=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,M={...G(f,c.node().type.name,c.node().attrs),...e},k=((i=a.contentMatch.defaultType)==null?void 0:i.createAndFill(M))||void 0;v=v.append(O.from(a.createAndFill(null,k)||void 0));const S=c.before(c.depth-(y-1));n.replace(S,c.after(-w),new De(v,4-y,0));let E=-1;n.doc.nodesBetween(S,n.doc.content.size,(A,C)=>{if(E>-1)return!1;A.isTextblock&&A.content.size===0&&(E=C+1)}),E>-1&&n.setSelection($.near(n.doc.resolve(E))),n.scrollIntoView()}return!0}const p=l.pos===c.end()?d.contentMatchAt(0).defaultType:null,m={...G(f,d.type.name,d.attrs),...e},h={...G(f,c.node().type.name,c.node().attrs),...e};n.delete(c.pos,l.pos);const g=p?[{type:a,attrs:m},{type:p,attrs:h}]:[{type:a,attrs:m}];if(!Z(n.doc,c.pos,2))return!1;if(s){const{selection:v,storedMarks:y}=r,{splittableMarks:w}=o.extensionManager,M=y||v.$to.parentOffset&&v.$from.marks();if(n.split(c.pos,2,g).scrollIntoView(),!M||!s)return!0;const k=M.filter(S=>w.includes(S.type.name));n.ensureMarks(k)}return!0},dt=(t,e)=>{const n=st(i=>i.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===s?.type&&mt(t.doc,n.pos)&&t.join(n.pos),!0},ut=(t,e)=>{const n=st(i=>i.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===s?.type&&mt(t.doc,r)&&t.join(r),!0},ir=(t,e,n,r={})=>({editor:s,tr:o,state:i,dispatch:a,chain:c,commands:l,can:u})=>{const{extensions:d,splittableMarks:f}=s.extensionManager,p=T(t,i.schema),m=T(e,i.schema),{selection:h,storedMarks:g}=i,{$from:v,$to:y}=h,w=v.blockRange(y),M=g||h.$to.parentOffset&&h.$from.marks();if(!w)return!1;const k=st(S=>Nt(S.type.name,d))(h);if(w.depth>=1&&k&&w.depth-k.depth<=1){if(k.node.type===p)return l.liftListItem(m);if(Nt(k.node.type.name,d)&&p.validContent(k.node.content)&&a)return c().command(()=>(o.setNodeMarkup(k.pos,p),!0)).command(()=>dt(o,p)).command(()=>ut(o,p)).run()}return!n||!M||!a?c().command(()=>u().wrapInList(p,r)?!0:l.clearNodes()).wrapInList(p,r).command(()=>dt(o,p)).command(()=>ut(o,p)).run():c().command(()=>{const S=u().wrapInList(p,r),E=M.filter(A=>f.includes(A.type.name));return o.ensureMarks(E),S?!0:l.clearNodes()}).wrapInList(p,r).command(()=>dt(o,p)).command(()=>ut(o,p)).run()},ar=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:o=!1}=n,i=N(t,r.schema);return pt(r,i,e)?s.unsetMark(i,{extendEmptyMarkRange:o}):s.setMark(i,e)},cr=(t,e,n={})=>({state:r,commands:s})=>{const o=T(t,r.schema),i=T(e,r.schema),a=V(r,o,n);let c;return r.selection.$anchor.sameParent(r.selection.$head)&&(c=r.selection.$anchor.parent.attrs),a?s.setNode(i,c):s.setNode(o,{...c,...n})},lr=(t,e={})=>({state:n,commands:r})=>{const s=T(t,n.schema);return V(n,s,e)?r.lift(s):r.wrapIn(s,e)},dr=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let o;if(s.spec.isInputRules&&(o=s.getState(t))){if(e){const i=t.tr,a=o.transform;for(let c=a.steps.length-1;c>=0;c-=1)i.step(a.steps[c].invert(a.docs[c]));if(o.text){const c=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,t.schema.text(o.text,c))}else i.delete(o.from,o.to)}return!0}}return!1},ur=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},fr=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var o;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,c=N(t,r.schema),{$from:l,empty:u,ranges:d}=a;if(!s)return!0;if(u&&i){let{from:f,to:p}=a;const m=(o=l.marks().find(g=>g.type===c))==null?void 0:o.attrs,h=vt(l,c,m);h&&(f=h.from,p=h.to),n.removeMark(f,p,c)}else d.forEach(f=>{n.removeMark(f.$from.pos,f.$to.pos,c)});return n.removeStoredMark(c),!0},pr=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=rt(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=T(t,r.schema)),a==="mark"&&(i=N(t,r.schema)),s&&n.selection.ranges.forEach(c=>{const l=c.$from.pos,u=c.$to.pos;let d,f,p,m;n.selection.empty?r.doc.nodesBetween(l,u,(h,g)=>{o&&o===h.type&&(p=Math.max(g,l),m=Math.min(g+h.nodeSize,u),d=g,f=h)}):r.doc.nodesBetween(l,u,(h,g)=>{g<l&&o&&o===h.type&&(p=Math.max(g,l),m=Math.min(g+h.nodeSize,u),d=g,f=h),g>=l&&g<=u&&(o&&o===h.type&&n.setNodeMarkup(g,void 0,{...h.attrs,...e}),i&&h.marks.length&&h.marks.forEach(v=>{if(i===v.type){const y=Math.max(g,l),w=Math.min(g+h.nodeSize,u);n.addMark(y,w,i.create({...v.attrs,...e}))}}))}),f&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...f.attrs,...e}),i&&f.marks.length&&f.marks.forEach(h=>{i===h.type&&n.addMark(p,m,i.create({...h.attrs,...e}))}))}),!0):!1},mr=(t,e={})=>({state:n,dispatch:r})=>{const s=T(t,n.schema);return ze(s,e)(n,r)},hr=(t,e={})=>({state:n,dispatch:r})=>{const s=T(t,n.schema);return Fe(s,e)(n,r)},gr=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},W=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},vr=(t,e)=>{if(gt(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function K(t){var e;const{editor:n,from:r,to:s,text:o,rules:i,plugin:a}=t,{view:c}=n;if(c.composing)return!1;const l=c.state.doc.resolve(r);if(l.parent.type.spec.code||(e=l.nodeBefore||l.nodeAfter)!=null&&e.marks.find(f=>f.type.spec.code))return!1;let u=!1;const d=Qn(l)+o;return i.forEach(f=>{if(u)return;const p=vr(d,f.find);if(!p)return;const m=c.state.tr,h=et({state:c.state,transaction:m}),g={from:r-(p[0].length-o.length),to:s},{commands:v,chain:y,can:w}=new nt({editor:n,state:h});f.handler({state:h,range:g,match:p,commands:v,chain:y,can:w})===null||!m.steps.length||(f.undoable&&m.setMeta(a,{transform:m,from:r,to:s,text:o}),c.dispatch(m),u=!0)}),u}function br(t){const{editor:e,rules:n}=t,r=new I({state:{init(){return null},apply(s,o,i){const a=s.getMeta(r);if(a)return a;const c=s.getMeta("applyInputRules");return!!c&&setTimeout(()=>{let{text:u}=c;typeof u=="string"?u=u:u=kt(O.from(u),i.schema);const{from:d}=c,f=d+u.length;K({editor:e,from:d,to:f,text:u,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:o}},props:{handleTextInput(s,o,i,a){return K({editor:e,from:o,to:i,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&K({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?K({editor:e,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function yr(t){return Object.prototype.toString.call(t).slice(8,-1)}function J(t){return yr(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Qt(t,e){const n={...t};return J(t)&&J(e)&&Object.keys(e).forEach(r=>{J(e[r])&&J(t[r])?n[r]=Qt(t[r],e[r]):n[r]=e[r]}),n}var xt=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...x(b(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...x(b(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Qt(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},kr=class Zt extends xt{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new Zt(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(l=>l?.type.name===n.name))return!1;const c=i.find(l=>l?.type.name===n.name);return c&&r.removeStoredMark(c),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function wr(t){return typeof t=="number"}var Mr=class{constructor(t){this.find=t.find,this.handler=t.handler}},xr=(t,e,n)=>{if(gt(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(s=>{const o=[s.text];return o.index=s.index,o.input=t,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]};function Sr(t){const{editor:e,state:n,from:r,to:s,rule:o,pasteEvent:i,dropEvent:a}=t,{commands:c,chain:l,can:u}=new nt({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,s,(p,m)=>{var h,g,v,y,w;if((g=(h=p.type)==null?void 0:h.spec)!=null&&g.code||!(p.isText||p.isTextblock||p.isInline))return;const M=(w=(y=(v=p.content)==null?void 0:v.size)!=null?y:p.nodeSize)!=null?w:0,k=Math.max(r,m),S=Math.min(s,m+M);if(k>=S)return;const E=p.isText?p.text||"":p.textBetween(k-m,S-m,void 0,"￼");xr(E,o.find,i).forEach(C=>{if(C.index===void 0)return;const j=k+C.index+1,it=j+C[0].length,q={from:n.tr.mapping.map(j),to:n.tr.mapping.map(it)},at=o.handler({state:n,range:q,match:C,commands:c,chain:l,can:u,pasteEvent:i,dropEvent:a});d.push(at)})}),d.every(p=>p!==null)}var Q=null,Er=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function Tr(t){const{editor:e,rules:n}=t;let r=null,s=!1,o=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const c=({state:u,from:d,to:f,rule:p,pasteEvt:m})=>{const h=u.tr,g=et({state:u,transaction:h});if(!(!Sr({editor:e,state:g,from:Math.max(d-1,0),to:f.b-1,rule:p,pasteEvent:m,dropEvent:a})||!h.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,h}};return n.map(u=>new I({view(d){const f=m=>{var h;r=(h=d.dom.parentElement)!=null&&h.contains(m.target)?d.dom.parentElement:null,r&&(Q=e)},p=()=>{Q&&(Q=null)};return window.addEventListener("dragstart",f),window.addEventListener("dragend",p),{destroy(){window.removeEventListener("dragstart",f),window.removeEventListener("dragend",p)}}},props:{handleDOMEvents:{drop:(d,f)=>{if(o=r===d.dom.parentElement,a=f,!o){const p=Q;p?.isEditable&&setTimeout(()=>{const m=p.state.selection;m&&p.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(d,f)=>{var p;const m=(p=f.clipboardData)==null?void 0:p.getData("text/html");return i=f,s=!!m?.includes("data-pm-slice"),!1}}},appendTransaction:(d,f,p)=>{const m=d[0],h=m.getMeta("uiEvent")==="paste"&&!s,g=m.getMeta("uiEvent")==="drop"&&!o,v=m.getMeta("applyPasteRules"),y=!!v;if(!h&&!g&&!y)return;if(y){let{text:k}=v;typeof k=="string"?k=k:k=kt(O.from(k),p.schema);const{from:S}=v,E=S+k.length,A=Er(k);return c({rule:u,state:p,from:S,to:{b:E},pasteEvt:A})}const w=f.doc.content.findDiffStart(p.doc.content),M=f.doc.content.findDiffEnd(p.doc.content);if(!(!wr(w)||!M||w===M.b))return c({rule:u,state:p,from:w,to:M,pasteEvt:i})}}))}var ot=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=qt(t),this.schema=Ln(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:lt(e.name,this.schema)},r=b(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return wt([...this.extensions].reverse()).flatMap(r=>{const s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:lt(r.name,this.schema)},o=[],i=b(r,"addKeyboardShortcuts",s);let a={};if(r.type==="mark"&&b(r,"exitable",s)&&(a.ArrowRight=()=>kr.handleExit({editor:t,mark:r})),i){const f=Object.fromEntries(Object.entries(i()).map(([p,m])=>[p,()=>m({editor:t})]));a={...a,...f}}const c=pe(a);o.push(c);const l=b(r,"addInputRules",s);if(It(r,t.options.enableInputRules)&&l){const f=l();if(f&&f.length){const p=br({editor:t,rules:f}),m=Array.isArray(p)?p:[p];o.push(...m)}}const u=b(r,"addPasteRules",s);if(It(r,t.options.enablePasteRules)&&u){const f=u();if(f&&f.length){const p=Tr({editor:t,rules:f});o.push(...p)}}const d=b(r,"addProseMirrorPlugins",s);if(d){const f=d();o.push(...f)}return o})}get attributes(){return Wt(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=H(this.extensions);return Object.fromEntries(e.filter(n=>!!b(n,"addNodeView")).map(n=>{const r=this.attributes.filter(a=>a.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:T(n.name,this.schema)},o=b(n,"addNodeView",s);if(!o)return[];const i=(a,c,l,u,d)=>{const f=Y(a,r);return o()({node:a,view:c,getPos:l,decorations:u,innerDecorations:d,editor:t,extension:n,HTMLAttributes:f})};return[n.name,i]}))}get markViews(){const{editor:t}=this,{markExtensions:e}=H(this.extensions);return Object.fromEntries(e.filter(n=>!!b(n,"addMarkView")).map(n=>{const r=this.attributes.filter(a=>a.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:N(n.name,this.schema)},o=b(n,"addMarkView",s);if(!o)return[];const i=(a,c,l)=>{const u=Y(a,r);return o()({mark:a,view:c,inline:l,editor:t,extension:n,HTMLAttributes:u,updateAttributes:d=>{zr(a,t,d)}})};return[n.name,i]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:lt(e.name,this.schema)};e.type==="mark"&&((n=x(b(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const s=b(e,"onBeforeCreate",r),o=b(e,"onCreate",r),i=b(e,"onUpdate",r),a=b(e,"onSelectionUpdate",r),c=b(e,"onTransaction",r),l=b(e,"onFocus",r),u=b(e,"onBlur",r),d=b(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),o&&this.editor.on("create",o),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),c&&this.editor.on("transaction",c),l&&this.editor.on("focus",l),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}};ot.resolve=qt;ot.sort=wt;ot.flatten=yt;var Ar={};ht(Ar,{ClipboardTextSerializer:()=>Xt,Commands:()=>Yt,Delete:()=>te,Drop:()=>ee,Editable:()=>ne,FocusEvents:()=>se,Keymap:()=>oe,Paste:()=>ie,Tabindex:()=>ae,focusEventsPluginKey:()=>re});var R=class Gt extends xt{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new Gt(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},Xt=R.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new I({key:new D("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:o}=s,i=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),c=Kt(n);return Ut(r,{from:i,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}}),Yt=R.create({name:"commands",addCommands(){return{...jt}}}),te=R.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,s;const o=()=>{var i,a,c,l;if((l=(c=(a=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:a.filterTransaction)==null?void 0:c.call(a,t))!=null?l:t.getMeta("y-sync$"))return;const u=On(t.before,[t,...e]);Jn(u).forEach(p=>{u.mapping.mapResult(p.oldRange.from).deletedAfter&&u.mapping.mapResult(p.oldRange.to).deletedBefore&&u.before.nodesBetween(p.oldRange.from,p.oldRange.to,(m,h)=>{const g=h+m.nodeSize-2,v=p.oldRange.from<=h&&g<=p.oldRange.to;this.editor.emit("delete",{type:"node",node:m,from:h,to:g,newFrom:u.mapping.map(h),newTo:u.mapping.map(g),deletedRange:p.oldRange,newRange:p.newRange,partial:!v,editor:this.editor,transaction:t,combinedTransform:u})})});const f=u.mapping;u.steps.forEach((p,m)=>{var h,g;if(p instanceof he){const v=f.slice(m).map(p.from,-1),y=f.slice(m).map(p.to),w=f.invert().map(v,-1),M=f.invert().map(y),k=(h=u.doc.nodeAt(v-1))==null?void 0:h.marks.some(E=>E.eq(p.mark)),S=(g=u.doc.nodeAt(y))==null?void 0:g.marks.some(E=>E.eq(p.mark));this.editor.emit("delete",{type:"mark",mark:p.mark,from:p.from,to:p.to,deletedRange:{from:w,to:M},newRange:{from:v,to:y},partial:!!(S||k),editor:this.editor,transaction:t,combinedTransform:u})}})};(s=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||s?setTimeout(o,0):o()}}),ee=R.create({name:"drop",addProseMirrorPlugins(){return[new I({key:new D("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),ne=R.create({name:"editable",addProseMirrorPlugins(){return[new I({key:new D("editable"),props:{editable:()=>this.editor.options.editable}})]}}),re=new D("focusEvents"),se=R.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new I({key:re,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),oe=R.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:c,doc:l}=a,{empty:u,$anchor:d}=c,{pos:f,parent:p}=d,m=d.parent.isTextblock&&f>0?a.doc.resolve(f-1):d,h=m.parent.type.spec.isolating,g=d.pos-d.parentOffset,v=h&&m.parent.childCount===1?g===d.pos:F.atStart(l).from===f;return!u||!p.type.isTextblock||p.textContent.length||!v||v&&d.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return bt()||Lt()?o:s},addProseMirrorPlugins(){return[new I({key:new D("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(h=>h.getMeta("composition")))return;const r=t.some(h=>h.docChanged)&&!e.doc.eq(n.doc),s=t.some(h=>h.getMeta("preventClearDocument"));if(!r||s)return;const{empty:o,from:i,to:a}=e.selection,c=F.atStart(e.doc).from,l=F.atEnd(e.doc).to;if(o||!(i===c&&a===l)||!Mt(n.doc))return;const f=n.tr,p=et({state:n,transaction:f}),{commands:m}=new nt({editor:this.editor,state:p});if(m.clearNodes(),!!f.steps.length)return f}})]}}),ie=R.create({name:"paste",addProseMirrorPlugins(){return[new I({key:new D("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),ae=R.create({name:"tabindex",addProseMirrorPlugins(){return[new I({key:new D("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),Cr=class z{constructor(e,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new z(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new z(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new z(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,i=this.pos+r+(o?0:1);if(i<0||i>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(i);if(!s&&a.depth<=this.depth)return;const c=new z(a,this.editor,s,s?n:null);s&&(c.actualDepth=this.depth+1),e.push(new z(a,this.editor,s,s?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(n).length>0){const o=s.node.attrs,i=Object.keys(n);for(let a=0;a<i.length;a+=1){const c=i[a];if(o[c]!==n[c])break}}else r=s;s=s.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const o=Object.keys(n);return this.children.forEach(i=>{r&&s.length>0||(i.node.type.name===e&&o.every(c=>n[c]===i.node.attrs[c])&&s.push(i),!(r&&s.length>0)&&(s=s.concat(i.querySelectorAll(e,n,r))))}),s}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},$r=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function Pr(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}var Ur=class extends gr{constructor(t={}){super(),this.css=null,this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:s,moved:o})=>this.options.onDrop(r,s,o)),this.on("paste",({event:r,slice:s})=>this.options.onPaste(r,s)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=zt(e,this.options.autofocus);this.editorState=ue.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=Pr($r,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=Ht(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(s=>{const o=typeof s=="string"?`${s}$`:s.key;n=n.filter(i=>!i.key.startsWith(o))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[ne,Xt.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),Yt,se,oe,ae,ee,ie,te].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s?.type));this.extensionManager=new ot(r,this)}createCommandManager(){this.commandManager=new nt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=ft(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=ft(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var e;this.editorView=new fe(t,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)==null?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(l=>{var u;return(u=this.capturedTransaction)==null?void 0:u.step(l)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),s=n.includes(t),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!s)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=n.findLast(l=>l.getMeta("focus")||l.getMeta("blur")),a=i?.getMeta("focus"),c=i?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:i}),c&&this.emit("blur",{editor:this,event:c.event,transaction:i}),!(t.getMeta("preventUpdate")||!n.some(l=>l.docChanged)||o.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return qn(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return Zn(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return kt(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return Hn(this.state.doc,{blockSeparator:e,textSerializers:{...Kt(this.schema),...n}})}get isEmpty(){return Mt(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new Cr(e,this)}get $doc(){return this.$pos(0)}};function Kr(t){return new W({find:t.find,handler:({state:e,range:n,match:r})=>{const s=x(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=e,i=r[r.length-1],a=r[0];if(i){const c=a.search(/\S/),l=n.from+a.indexOf(i),u=l+i.length;if(Jt(n.from,n.to,e.doc).filter(p=>p.mark.type.excluded.find(h=>h===t.type&&h!==p.mark.type)).filter(p=>p.to>l).length)return null;u<n.to&&o.delete(u,n.to),l>n.from&&o.delete(n.from+c,l);const f=n.from+c+i.length;o.addMark(n.from+c,f,t.type.create(s||{})),o.removeStoredMark(t.type)}},undoable:t.undoable})}function Jr(t){return new W({find:t.find,handler:({state:e,range:n,match:r})=>{const s=x(t.getAttributes,void 0,r)||{},{tr:o}=e,i=n.from;let a=n.to;const c=t.type.create(s);if(r[1]){const l=r[0].lastIndexOf(r[1]);let u=i+l;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,i+r[0].length-1),o.replaceWith(u,a,c)}else if(r[0]){const l=t.type.isInline?i:i-1;o.insert(l,t.type.create(s)).delete(o.mapping.map(i),o.mapping.map(a))}o.scrollIntoView()},undoable:t.undoable})}function Qr(t){return new W({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),o=x(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)},undoable:t.undoable})}function Zr(t){return new W({find:t.find,handler:({state:e,range:n,match:r})=>{let s=t.replace,o=n.from;const i=n.to;if(r[1]){const a=r[0].lastIndexOf(r[1]);s+=r[0].slice(a+r[1].length),o+=a;const c=o-i;c>0&&(s=r[0].slice(a-c,a)+s,o=i)}e.tr.insertText(s,o,i)},undoable:t.undoable})}function Gr(t){return new W({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const o=x(t.getAttributes,void 0,r)||{},i=e.tr.delete(n.from,n.to),c=i.doc.resolve(n.from).blockRange(),l=c&&le(c,t.type,o);if(!l)return null;if(i.wrap(c,l),t.keepMarks&&t.editor){const{selection:d,storedMarks:f}=e,{splittableMarks:p}=t.editor.extensionManager,m=f||d.$to.parentOffset&&d.$from.marks();if(m){const h=m.filter(g=>p.includes(g.type.name));i.ensureMarks(h)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(d,o).run()}const u=i.doc.resolve(n.from-1).nodeBefore;u&&u.type===t.type&&mt(i.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,u))&&i.join(n.from-1)},undoable:t.undoable})}function Xr(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof tt){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let s=r.depth;for(;s>=0;){const o=r.index(s);if(r.node(s).contentMatchAt(o).matchType(e))return!0;s-=1}return!1}function Yr(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var Ir={};ht(Ir,{createAtomBlockMarkdownSpec:()=>Nr,createBlockMarkdownSpec:()=>Rr,createInlineMarkdownSpec:()=>jr,parseAttributes:()=>St,parseIndentedBlocks:()=>_r,renderNestedMarkdownContent:()=>Dr,serializeAttributes:()=>Et});function St(t){if(!t?.trim())return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,l=>(n.push(l),`__QUOTED_${n.length-1}__`)),s=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const l=s.map(u=>u.trim().slice(1));e.class=l.join(" ")}const o=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(e.id=o[1]);const i=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(i)).forEach(([,l,u])=>{var d;const f=parseInt(((d=u.match(/__QUOTED_(\d+)__/))==null?void 0:d[1])||"0",10),p=n[f];p&&(e[l]=p.slice(1,-1))});const c=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return c&&c.split(/\s+/).filter(Boolean).forEach(u=>{u.match(/^[a-zA-Z][\w-]*$/)&&(e[u]=!0)}),e}function Et(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function Nr(t){const{nodeName:e,name:n,parseAttributes:r=St,serializeAttributes:s=Et,defaultAttributes:o={},requiredAttributes:i=[],allowedAttributes:a}=t,c=n||e,l=u=>{if(!a)return u;const d={};return a.forEach(f=>{f in u&&(d[f]=u[f])}),d};return{parseMarkdown:(u,d)=>{const f={...o,...u.attributes};return d.createNode(e,f,[])},markdownTokenizer:{name:e,level:"block",start(u){var d;const f=new RegExp(`^:::${c}(?:\\s|$)`,"m"),p=(d=u.match(f))==null?void 0:d.index;return p!==void 0?p:-1},tokenize(u,d,f){const p=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),m=u.match(p);if(!m)return;const h=m[1]||"",g=r(h);if(!i.find(y=>!(y in g)))return{type:e,raw:m[0],attributes:g}}},renderMarkdown:u=>{const d=l(u.attrs||{}),f=s(d),p=f?` {${f}}`:"";return`:::${c}${p} :::`}}}function Rr(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=St,serializeAttributes:o=Et,defaultAttributes:i={},content:a="block",allowedAttributes:c}=t,l=n||e,u=d=>{if(!c)return d;const f={};return c.forEach(p=>{p in d&&(f[p]=d[p])}),f};return{parseMarkdown:(d,f)=>{let p;if(r){const h=r(d);p=typeof h=="string"?[{type:"text",text:h}]:h}else a==="block"?p=f.parseChildren(d.tokens||[]):p=f.parseInline(d.tokens||[]);const m={...i,...d.attributes};return f.createNode(e,m,p)},markdownTokenizer:{name:e,level:"block",start(d){var f;const p=new RegExp(`^:::${l}`,"m"),m=(f=d.match(p))==null?void 0:f.index;return m!==void 0?m:-1},tokenize(d,f,p){var m;const h=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),g=d.match(h);if(!g)return;const[v,y=""]=g,w=s(y);let M=1;const k=v.length;let S="";const E=/^:::([\w-]*)(\s.*)?/gm,A=d.slice(k);for(E.lastIndex=0;;){const C=E.exec(A);if(C===null)break;const j=C.index,it=C[1];if(!((m=C[2])!=null&&m.endsWith(":::"))){if(it)M+=1;else if(M-=1,M===0){const q=A.slice(0,j);S=q.trim();const at=d.slice(0,k+j+C[0].length);let B=[];if(S)if(a==="block")for(B=p.blockTokens(q),B.forEach(P=>{P.text&&(!P.tokens||P.tokens.length===0)&&(P.tokens=p.inlineTokens(P.text))});B.length>0;){const P=B[B.length-1];if(P.type==="paragraph"&&(!P.text||P.text.trim()===""))B.pop();else break}else B=p.inlineTokens(S);return{type:e,raw:at,attributes:w,content:S,tokens:B}}}}}},renderMarkdown:(d,f)=>{const p=u(d.attrs||{}),m=o(p),h=m?` {${m}}`:"",g=f.renderChildren(d.content||[],`

`);return`:::${l}${h}

${g}

:::`}}}function Br(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,s,o,i]=r;e[s]=o||i,r=n.exec(t)}return e}function Or(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function jr(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=Br,serializeAttributes:o=Or,defaultAttributes:i={},selfClosing:a=!1,allowedAttributes:c}=t,l=n||e,u=f=>{if(!c)return f;const p={};return c.forEach(m=>{m in f&&(p[m]=f[m])}),p},d=l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(f,p)=>{const m={...i,...f.attributes};if(a)return p.createNode(e,m);const h=r?r(f):f.content||"";return h?p.createNode(e,m,[p.createTextNode(h)]):p.createNode(e,m,[])},markdownTokenizer:{name:e,level:"inline",start(f){const p=a?new RegExp(`\\[${d}\\s*[^\\]]*\\]`):new RegExp(`\\[${d}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${d}\\]`),m=f.match(p),h=m?.index;return h!==void 0?h:-1},tokenize(f,p,m){const h=a?new RegExp(`^\\[${d}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${d}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${d}\\]`),g=f.match(h);if(!g)return;let v="",y="";if(a){const[,M]=g;y=M}else{const[,M,k]=g;y=M,v=k||""}const w=s(y.trim());return{type:e,raw:g[0],content:v.trim(),attributes:w}}},renderMarkdown:f=>{let p="";r?p=r(f):f.content&&f.content.length>0&&(p=f.content.filter(v=>v.type==="text").map(v=>v.text).join(""));const m=u(f.attrs||{}),h=o(m),g=h?` ${h}`:"";return a?`[${l}${g}]`:`[${l}${g}]${p}[/${l}]`}}}function _r(t,e,n){var r,s,o,i;const a=t.split(`
`),c=[];let l="",u=0;const d=e.baseIndentSize||2;for(;u<a.length;){const f=a[u],p=f.match(e.itemPattern);if(!p){if(c.length>0)break;if(f.trim()===""){u+=1;continue}else return}const m=e.extractItemData(p),{indentLevel:h,mainContent:g}=m;l=`${l}${f}
`;const v=[g];for(u+=1;u<a.length;){const k=a[u];if(k.trim()===""){const E=a.slice(u+1).findIndex(j=>j.trim()!=="");if(E===-1)break;if((((s=(r=a[u+1+E].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:s.length)||0)>h){v.push(k),l=`${l}${k}
`,u+=1;continue}else break}if((((i=(o=k.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:i.length)||0)>h)v.push(k),l=`${l}${k}
`,u+=1;else break}let y;const w=v.slice(1);if(w.length>0){const k=w.map(S=>S.slice(h+d)).join(`
`);k.trim()&&(e.customNestedParser?y=e.customNestedParser(k):y=n.blockTokens(k))}const M=e.createToken(m,y);c.push(M)}if(c.length!==0)return{items:c,raw:l.trim()}}function Dr(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const s=typeof n=="function"?n(r):n,[o,...i]=t.content,a=e.renderChildren([o]),c=[`${s}${a}`];return i&&i.length>0&&i.forEach(l=>{const u=e.renderChildren([l]);if(u){const d=u.split(`
`).map(f=>f?e.indent(f):"").join(`
`);c.push(d)}}),c.join(`
`)}function zr(t,e,n={}){const{state:r}=e,{doc:s,tr:o}=r,i=t;s.descendants((a,c)=>{const l=o.mapping.map(c),u=o.mapping.map(c)+a.nodeSize;let d=null;if(a.marks.forEach(p=>{if(p!==i)return!1;d=p}),!d)return;let f=!1;if(Object.keys(n).forEach(p=>{n[p]!==d.attrs[p]&&(f=!0)}),f){const p=t.type.create({...t.attrs,...n});o.removeMark(l,u,t.type),o.addMark(l,u,p)}}),o.docChanged&&e.view.dispatch(o)}var ts=class ce extends xt{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new ce(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function es(t){return new Mr({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:s})=>{const o=x(t.getAttributes,void 0,r,s);if(o===!1||o===null)return null;const{tr:i}=e,a=r[r.length-1],c=r[0];let l=n.to;if(a){const u=c.search(/\S/),d=n.from+c.indexOf(a),f=d+a.length;if(Jt(n.from,n.to,e.doc).filter(m=>m.mark.type.excluded.find(g=>g===t.type&&g!==m.mark.type)).filter(m=>m.to>d).length)return null;f<n.to&&i.delete(f,n.to),d>n.from&&i.delete(n.from+u,d),l=n.from+u+a.length,i.addMark(n.from+u,l,t.type.create(o||{})),i.removeStoredMark(t.type)}}})}var ns=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]};export{Ur as A,Yr as B,R as E,kr as M,ts as N,es as a,Kr as b,Xr as c,On as d,Jt as e,Lr as f,Jn as g,ns as h,qr as i,qn as j,V as k,Wr as l,zn as m,Jr as n,Hr as o,_r as p,T as q,Dr as r,Vr as s,Qr as t,x as u,b as v,Gr as w,_n as x,Zr as y,Mt as z};
